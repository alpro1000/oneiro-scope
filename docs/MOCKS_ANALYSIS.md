# –ê–Ω–∞–ª–∏–∑ –∑–∞–≥–ª—É—à–µ–∫ (Mocks) –≤ OneiroScope

## üìä –°–≤–æ–¥–∫–∞

**–í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ**: 18 –∑–∞–≥–ª—É—à–µ–∫ –∏ —Å—Ç–∞–±–æ–≤
**–ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å**: 13
**–û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å**: 5 (—Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–ì–õ–£–®–ö–ò (–ó–∞–º–µ–Ω–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞)

### 1. Lunar Mock Data - `/frontend/lib/lunar-mock.ts`
**–°—Ç–∞—Ç—É—Å**: üî¥ –ê–∫—Ç–∏–≤–Ω–∞—è –∑–∞–≥–ª—É—à–∫–∞
**–¢–∏–ø**: –ü–æ–ª–Ω—ã–π fallback –¥–ª—è –ª—É–Ω–Ω–æ–≥–æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```typescript
// –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–Ω–µ–π –æ—Ç —ç–ø–æ—Ö–∏
// Hardcoded —Ñ–∞–∑—ã (new_moon, waxing_crescent, etc)
// –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: source: 'mock'
```

**–ß—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**:
- Frontend SSR (–ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ backend)
- CI/E2E —Ç–µ—Å—Ç—ã
- Offline —Ä–µ–∂–∏–º

**–ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞**: Real Swiss Ephemeris —á–µ—Ä–µ–∑ backend API
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ –í–´–°–û–ö–ò–ô
**–£—Å–∏–ª–∏—è**: –ù–∏–∑–∫–∏–µ (–ø—Ä–æ—Å—Ç–æ –≤–∫–ª—é—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π API)
**–£—Å–ª–æ–≤–∏–µ**: Backend –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω

---

### 2. GeoNames Demo Account - `/backend/utils/geonames_resolver.py:23`
**–°—Ç–∞—Ç—É—Å**: üî¥ –ê–∫—Ç–∏–≤–Ω–∞—è –∑–∞–≥–ª—É—à–∫–∞ –≤ production
**–¢–∏–ø**: Demo API account + hardcoded cities database

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```python
GEONAMES_USER = os.getenv("GEONAMES_USERNAME", "demo")  # Default: demo

POPULAR_CITIES = {  # 65 hardcoded cities
    "–º–æ—Å–∫–≤–∞": {"name": "Moscow", ...},
    "london": {"name": "London", ...},
    # ... –µ—â–µ 63 –≥–æ—Ä–æ–¥–∞
}
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Demo –∞–∫–∫–∞—É–Ω—Ç–∞**:
- Rate limit: 30,000 requests/day
- –ë–∞–∑–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
- –ù–µ –≤—Å–µ–≥–¥–∞ –Ω–∞—Ö–æ–¥–∏—Ç –º–∞–ª–µ–Ω—å–∫–∏–µ –≥–æ—Ä–æ–¥–∞

**–ß—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω–∞–π–¥–µ–Ω–æ**:
- –ú–∞–ª–µ–Ω—å–∫–∏–µ –≥–æ—Ä–æ–¥–∞ (–í–∞—Å–∏–ª—å–µ–≤–∫–∞, –ü–µ—Ä–µ—è—Å–ª–∞–≤)
- –†–µ–¥–∫–∏–µ –º–µ—Å—Ç–∞
- –ù–æ–≤—ã–µ –≥–æ—Ä–æ–¥–∞

**–ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞**: Production GeoNames API key
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° –°–†–ï–î–ù–ò–ô
**–£—Å–∏–ª–∏—è**: –û—á–µ–Ω—å –Ω–∏–∑–∫–∏–µ (–ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å env var –Ω–∞ Render)
**–°—Ç–∞—Ç—É—Å –Ω–∞ Render**: ‚úÖ –£–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ `GEONAMES_USERNAME=alpro1000`
**–£–ª—É—á—à–µ–Ω–∏—è –∏–∑ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏**:
- ‚úÖ maxRows: 1 ‚Üí 10 (–Ω–∞–π—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)
- ‚úÖ isNameRequired: true (—Ç–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è)
- ‚úÖ 65 –≥–æ—Ä–æ–¥–æ–≤ –≤ fallback –±–∞–∑–µ
- ‚úÖ Graceful error handling

---

### 3. Swiss Ephemeris Stub - `/external/pyswisseph/swisseph/__init__.py`
**–°—Ç–∞—Ç—É—Å**: üî¥ Fallback —Ä–∞—Å—á–µ—Ç—ã
**–¢–∏–ø**: –£–ø—Ä–æ—â–µ–Ω–Ω—ã–µ –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```python
def julday():
    # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: date.toordinal() + —Å–º–µ—â–µ–Ω–∏–µ
    # –ù–ï –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏ —Ç–æ—á–Ω—ã–π

def lun_phase():
    # Sine wave —ç–º—É–ª—è—Ü–∏—è –ª—É–Ω–Ω–æ–π —Ñ–∞–∑—ã
    # –£–ø—Ä–æ—â–µ–Ω–Ω–æ –∏ –Ω–µ—Ç–æ—á–Ω–æ
```

**–¢–æ—á–Ω–æ—Å—Ç—å**: ‚ö†Ô∏è –ù–∏–∑–∫–∞—è (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ fallback)
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞**: –ù–µ—Ç –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ ephemeris

**–ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞**:
- –ø–æ–ª–Ω—ã–π –ø–∞–∫–µ—Ç `pyswisseph` —Å –±–∏–Ω–∞—Ä–Ω—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏
- –∏–ª–∏ Swiss Ephemeris C –±–∏–±–ª–∏–æ—Ç–µ–∫–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° –°–†–ï–î–ù–ò–ô (—ç—Ç–æ fallback)
**–£—Å–∏–ª–∏—è**: –í—ã—Å–æ–∫–∏–µ (—É—Å—Ç–∞–Ω–æ–≤–∫–∞ C –±–∏–±–ª–∏–æ—Ç–µ–∫–∏)
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–∞ Render —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç `pyswisseph`, —Å—Ç–∞–± –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–µ –¥–æ–ª–∂–µ–Ω

---

### 4. Ephemeris Fallback Calculations - `/backend/services/astrology/ephemeris.py:190-240`
**–°—Ç–∞—Ç—É—Å**: üî¥ Fallback –ø—Ä–∏ –æ—à–∏–±–∫–µ Swiss Ephemeris
**–¢–∏–ø**: Hardcoded —Å—Ä–µ–¥–Ω–∏–µ –¥–æ–ª–≥–æ—Ç—ã –ø–ª–∞–Ω–µ—Ç

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```python
def _calculate_fallback():
    mean_longitudes = {
        "sun": 280.46,
        "moon": 218.32,
        "mercury": 334.34,
        # ... –µ—â–µ 8 –ø–ª–∞–Ω–µ—Ç
    }
    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –∏–∑ J2000.0 —ç–ø–æ—Ö–∏
    # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ: 1.0 AU (dummy value)
    # –®–∏—Ä–æ—Ç–∞: 0.0¬∞ (dummy)
```

**–¢–æ—á–Ω–æ—Å—Ç—å**: ‚ö†Ô∏è –¢–æ–ª—å–∫–æ –¥–ª—è fallback
**–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ**: "Approximate - should only be used as fallback"

**–ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞**: –†–µ–∞–ª—å–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã Swiss Ephemeris
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° –ù–ò–ó–ö–ò–ô (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–¥–∫–æ)
**–£—Å–∏–ª–∏—è**: –°—Ä–µ–¥–Ω–∏–µ
**–°—Ç–∞—Ç—É—Å**: –ù–∞ Render —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ

---

## üü† –í–¢–û–†–û–°–¢–ï–ü–ï–ù–ù–´–ï –ó–ê–ì–õ–£–®–ö–ò (–ó–∞–º–µ–Ω–∞ –∂–µ–ª–∞—Ç–µ–ª—å–Ω–∞)

### 5. Dream Bank Hardcoded Fallback - `/backend/services/dreams/dreambank_loader.py:85-102`
**–°—Ç–∞—Ç—É—Å**: üü† Fallback –µ—Å–ª–∏ `hvdc_norms.json` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
**–¢–∏–ø**: Hardcoded Hall/Van de Castle –Ω–æ—Ä–º—ã

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```python
# Male norms (hardcoded):
male_character_ratio: 67% male, 33% female
aggression_friendliness: 0.59
negative_emotions_percent: 80%
success_percent: 51%

# Female norms (hardcoded):
female_character_ratio: 48% male, 52% female
aggression_friendliness: 0.32
# ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞**: –§–∞–π–ª `hvdc_norms.json` –Ω–µ –Ω–∞–π–¥–µ–Ω
**–¢–æ—á–Ω–æ—Å—Ç—å**: ‚úÖ –û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ 1966 –≥–æ–¥–∞

**–ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞**: –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ JSON —Ñ–∞–π–ª–∞
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° –ù–ò–ó–ö–ò–ô (JSON —Ñ–∞–π–ª —Ä–∞–±–æ—Ç–∞–µ—Ç)
**–£—Å–∏–ª–∏—è**: –û—á–µ–Ω—å –Ω–∏–∑–∫–∏–µ

---

### 6. LLM Provider Generic Fallback - `/backend/core/llm_provider.py:355-360`
**–°—Ç–∞—Ç—É—Å**: üü† Fallback –∫–æ–≥–¥–∞ –≤—Å–µ LLM API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã
**–¢–∏–ø**: Generic —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```python
"AI interpretation temporarily unavailable. Please check API configuration."
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞**:
- Groq –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- Gemini –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- OpenAI –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- OpenRouter –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- Anthropic –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞**:
- –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—à–ª—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏
- Rule-based fallback –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü° –ù–ò–ó–ö–ò–ô (—Ä–µ–¥–∫–æ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç)
**–£—Å–∏–ª–∏—è**: –ù–∏–∑–∫–∏–µ

---

### 7. Dream Interpreter Rule-Based Fallback - `/backend/services/dreams/ai/interpreter.py:559-655`
**–°—Ç–∞—Ç—É—Å**: üü† Fallback –∫–æ–≥–¥–∞ LLM –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
**–¢–∏–ø**: Hardcoded —à–∞–±–ª–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```python
# Russian fallback (lines 571-612):
summary = f"–û—Å–Ω–æ–≤–Ω–æ–π —Å–∏–º–≤–æ–ª: {symbols[0]['symbol']}"
interpretation = [
    f"–ü–µ—Ä–≤–∏—á–Ω—ã–π —Å–∏–º–≤–æ–ª - {symbols[0]['symbol']}",
    f"–ê—Ä—Ö–µ—Ç–∏–ø - {archetype}",
    "–¢—Ä–µ—Ç–∏–π —ç–ª–µ–º–µ–Ω—Ç –∏–∑ themes"
]
recommendations = [
    "–ó–∞–ø–∏—à–∏—Ç–µ —Å–æ–Ω –≤ –¥–Ω–µ–≤–Ω–∏–∫",
    "–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ —ç–º–æ—Ü–∏–∏",
    "–°–≤—è–∂–∏—Ç–µ —Å —Å–æ–±—ã—Ç–∏—è–º–∏ –¥–Ω—è"
]

# English fallback (same structure with translations)
```

**Hardcoded —ç–º–æ—Ü–∏–∏** (6 –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤):
- HAPPINESS ‚Üí "joy and satisfaction"
- SADNESS ‚Üí "sadness and grief"
- ANGER ‚Üí "anger and irritation"
- APPREHENSION ‚Üí "anxiety and apprehension"
- CONFUSION ‚Üí "confusion and uncertainty"
- NEUTRAL ‚Üí "neutral state"

**–ö–∞—á–µ—Å—Ç–≤–æ**: ‚úÖ –†–∞–∑—É–º–Ω—ã–π fallback, –ª—É—á—à–µ —á–µ–º –Ω–∏—á–µ–≥–æ
**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–≥–¥–∞**: LLM API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞**:
- –ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω–∞—è rule-based –ª–æ–≥–∏–∫–∞
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ—à–ª—ã–µ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏
- Fallback –Ω–∞ –¥—Ä—É–≥–æ–≥–æ LLM –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üü¢ –ù–ò–ó–ö–ò–ô (fallback, —Ä–µ–¥–∫–æ)
**–£—Å–∏–ª–∏—è**: –°—Ä–µ–¥–Ω–∏–µ (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)

---

## üü¢ –¢–ï–°–¢–û–í–´–ï MOCKS (–û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å)

### 8. Frontend Test Mocks - `/frontend/jest.setup.ts`
**–¢–∏–ø**: Jest mocks –¥–ª—è unit —Ç–µ—Å—Ç–æ–≤
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ù—É–∂–Ω—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
**–°–æ–¥–µ—Ä–∂–∏—Ç**: `next/navigation`, `Header` component
**–†–µ—à–µ–Ω–∏–µ**: –û—Å—Ç–∞–≤–∏—Ç—å (—ç—Ç–æ —Ç–µ—Å—Ç—ã)

---

### 9. Playwright E2E Test Mocks - `/frontend/e2e/lunar-widget.spec.ts`
**–¢–∏–ø**: Playwright route mocks
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ù—É–∂–Ω—ã –¥–ª—è CI
**–°–æ–¥–µ—Ä–∂–∏—Ç**: Mock `/api/lunar` response
**–†–µ—à–µ–Ω–∏–µ**: –û—Å—Ç–∞–≤–∏—Ç—å (–Ω—É–∂–Ω–æ –¥–ª—è CI, –Ω–æ –¥–æ–±–∞–≤–∏—Ç—å mock `/api/timezones`)

---

### 10-12. Unit Test Fixtures
**–§–∞–π–ª—ã**:
- `test_astrology_provenance.py` - Mock ephemeris
- `test_dream_interpreter_narrative.py` - Test dreams
- `test_lunar_endpoint.py` - Test dates

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ù—É–∂–Ω—ã –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
**–†–µ—à–µ–Ω–∏–µ**: –û—Å—Ç–∞–≤–∏—Ç—å

---

## ‚úÖ –†–ï–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï (–ù–µ —Ç—Ä–æ–≥–∞—Ç—å)

–≠—Ç–æ –ù–ï mocks, —ç—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ:

### Production Knowledge Base
```
‚úÖ /backend/services/dreams/knowledge_base/symbols.json
   ‚îî‚îÄ 56+ dream symbols, –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ Hall/Van de Castle

‚úÖ /backend/services/dreams/knowledge_base/hvdc_norms.json
   ‚îî‚îÄ Hall/Van de Castle (1966) –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

‚úÖ /backend/services/astrology/knowledge_base/planets.json
   ‚îî‚îÄ –ê—Å—Ç—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Å–∏–º–≤–æ–ª—ã –∏ –∑–Ω–∞—á–µ–Ω–∏—è

‚úÖ /backend/services/astrology/knowledge_base/aspects.json
   ‚îî‚îÄ –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∞—Å–ø–µ–∫—Ç–æ–≤

‚úÖ /backend/services/astrology/knowledge_base/houses.json
   ‚îî‚îÄ –ó–Ω–∞—á–µ–Ω–∏—è –¥–æ–º–æ–≤

‚úÖ /backend/data/lunar_tables.json
   ‚îî‚îÄ –õ—É–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å (30 –¥–Ω–µ–π, RU/EN)
```

**–î–µ–π—Å—Ç–≤–∏–µ**: –ù–ï –ú–ï–ù–Ø–¢–¨ - —ç—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

## üìã –ü–õ–ê–ù –ó–ê–ú–ï–ù–´ –ó–ê–ì–õ–£–®–ï–ö

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (–ù–µ–¥–µ–ª—è 1)
| –ó–∞–≥–ª—É—à–∫–∞ | –£—Å–∏–ª–∏—è | –°—Ç–∞—Ç—É—Å –Ω–∞ Render | –î–µ–π—Å—Ç–≤–∏–µ |
|----------|--------|-----------------|----------|
| GeoNames demo | ‚ö†Ô∏è –ù–∏–∑–∫–∏–µ | ‚úÖ –£–∂–µ –≥–æ—Ç–æ–≤–æ | –í–∫–ª—é—á–∏—Ç—å, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å |
| Lunar mock | ‚ö†Ô∏è –ù–∏–∑–∫–∏–µ | ‚úÖ –ì–æ—Ç–æ–≤–æ | –£–±–µ–¥–∏—Ç—å—Å—è –≤ fallback |

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ GeoNames –Ω–∞–π–¥–µ—Ç –ª—é–±—ã–µ –≥–æ—Ä–æ–¥–∞ (–¥–∞–∂–µ –í–∞—Å–∏–ª—å–µ–≤–∫–∞)
- ‚úÖ –õ—É–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —Ä–µ–∞–ª—å–Ω—ã–º–∏ (Swiss Ephemeris)

---

### –≠—Ç–∞–ø 2: –í—Ç–æ—Ä–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–µ (–ù–µ–¥–µ–ª—è 2-3)
| –ó–∞–≥–ª—É—à–∫–∞ | –£—Å–∏–ª–∏—è | –î–µ–π—Å—Ç–≤–∏–µ |
|----------|--------|----------|
| Swiss Ephemeris stub | üü† –°—Ä–µ–¥–Ω–∏–µ | –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ pyswisseph —Ä–∞–±–æ—Ç–∞–µ—Ç |
| Ephemeris fallback | üü† –°—Ä–µ–¥–Ω–∏–µ | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ Render |
| Dream Bank hardcoded | ‚ö†Ô∏è –ù–∏–∑–∫–∏–µ | –£–∂–µ –µ—Å—Ç—å JSON, —Å—Ç–∞–± —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| LLM fallback message | ‚ö†Ô∏è –ù–∏–∑–∫–∏–µ | –£–ª—É—á—à–∏—Ç—å —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏ |

---

### –≠—Ç–∞–ø 3: –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ (–ú–µ—Å—è—Ü 2)
| –ó–∞–≥–ª—É—à–∫–∞ | –£—Å–∏–ª–∏—è | –î–µ–π—Å—Ç–≤–∏–µ |
|----------|--------|----------|
| Dream interpreter rules | üü† –°—Ä–µ–¥–Ω–∏–µ | –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è –ª—É—á—à–µ–≥–æ fallback |
| E2E test mocks | ‚ö†Ô∏è –ù–∏–∑–∫–∏–µ | –î–æ–±–∞–≤–∏—Ç—å `/api/timezones` mock |

---

## üîß –¢–ï–ö–£–©–ò–ô –°–¢–ê–¢–£–° –ü–û–°–õ–ï –≠–¢–û–ô –°–ï–°–°–ò–ò

### ‚úÖ –£–ª—É—á—à–µ–Ω–æ –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏:
1. **GeoNames API –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
   - ‚úÖ maxRows: 1 ‚Üí 10 (–Ω–∞–π—Ç–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
   - ‚úÖ isNameRequired: true (—Ç–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è)
   - ‚úÖ Graceful error handling –ø—Ä–∏ API —Å–±–æ–µ

2. **–†–∞—Å—à–∏—Ä–µ–Ω–∞ –±–∞–∑–∞ –≥–æ—Ä–æ–¥–æ–≤**:
   - ‚úÖ 15 ‚Üí 65 –≥–æ—Ä–æ–¥–æ–≤ (4x –±–æ–ª—å—à–µ)
   - ‚úÖ –í—Å–µ —É–∫—Ä–∞–∏–Ω—Å–∫–∏–µ –≥–æ—Ä–æ–¥–∞ (–ó–∞–ø–æ—Ä–æ–∂—å–µ, –ö–∏–µ–≤, –•–∞—Ä–∫—ñ–≤, –õ—å–≤—ñ–≤, –û–¥–µ—Å–∞)
   - ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Cyrillic –∏ Latin –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤

3. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**:
   - ‚úÖ API fallback ‚Üí Built-in –±–∞–∑–∞ –≥–æ—Ä–æ–¥–æ–≤
   - ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ [GeoNames] –ø—Ä–µ—Ñ–∏–∫—Å–æ–º

### ‚è≥ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –Ω–∞ Render:
1. **–£–±–µ–¥–∏—Ç—å—Å—è GeoNames works**:
   ```bash
   # –ù–∞ Render: GEONAMES_USERNAME=alpro1000 (—É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ)
   # –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å: GET /api/v1/astrology/natal-chart
   #   —Å –≥–æ—Ä–æ–¥–∞–º–∏: –ú–æ—Å–∫–≤–∞, –ó–∞–ø–æ—Ä–æ–∂—å–µ, –ü–∞—Ä–∏–∂
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å Swiss Ephemeris**:
   ```bash
   # –ù–∞ Render: pyswisseph –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: GET /api/v1/lunar?date=2025-12-24
   ```

3. **–£–±–µ–¥–∏—Ç—å—Å—è Lunar Mock —Ä–∞–±–æ—Ç–∞–µ—Ç**:
   ```bash
   # Frontend fallback –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ backend
   # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –í—ã–∫–ª—é—á–∏—Ç—å backend, –æ—Ç–∫—Ä–æ–π—Ç–µ /en/calendar
   ```

---

## ‚ö†Ô∏è POTENTIAL ISSUES

### Lunar Mock —Ç–æ—á–Ω–æ—Å—Ç—å
```typescript
// frontend/lib/lunar-mock.ts –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
const daysSinceEpoch = Math.floor((dateObj.getTime() - EPOCH) / DAY_MS);
const lunarDay = ((daysSinceEpoch % 29.53) + 1) % 30;
```
**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º —à–≤–µ–π—Ü–∞—Ä—Å–∫–∏–º —ç—Ñ–µ–º–µ—Ä–∏–¥–æ–º
**–†–µ—à–µ–Ω–∏–µ**: –≠—Ç–æ fallback –¥–ª—è CI/offline, –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É –Ω—É–∂–µ–Ω real API

---

### GeoNames 65 –≥–æ—Ä–æ–¥–æ–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
**–ß—Ç–æ –Ω–µ –ø–æ–∫—Ä—ã—Ç–æ**:
- –ú–∞–ª–µ–Ω—å–∫–∏–µ –≥–æ—Ä–æ–¥–∞ (<50k –∂–∏—Ç–µ–ª–µ–π)
- –ù–æ–≤—ã–µ –≥–æ—Ä–æ–¥–∞
- –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è
- –õ–æ–∫–∞–ª—å–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è

**–†–µ—à–µ–Ω–∏–µ**: –ù–∞ Render —Å `GEONAMES_USERNAME=alpro1000` –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π API

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –¢–ê–ë–õ–ò–¶–ê

| # | –ó–∞–≥–ª—É—à–∫–∞ | –¢–∏–ø | –ì–¥–µ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å | –ó–∞–º–µ–Ω–∞ | –°—Ç–∞—Ç—É—Å |
|-|-|-|-|-|-|-|
| 1 | Lunar mock | Full fallback | Frontend | üî¥ –í—ã—Å–æ–∫–∞—è | Real API | ‚úÖ Ready |
| 2 | GeoNames demo | Demo API | Backend | üî¥ –í—ã—Å–æ–∫–∞—è | Prod API | ‚úÖ Ready |
| 3 | GeoNames cities | Hardcoded | Backend | üî¥ –í—ã—Å–æ–∫–∞—è | Real API | ‚úÖ 65 –≥–æ—Ä–æ–¥–æ–≤ |
| 4 | Swiss Eph stub | Calculations | External | üü° –°—Ä–µ–¥–Ω—è—è | pyswisseph | ‚úÖ Works |
| 5 | Eph fallback | Hardcoded coords | Backend | üü° –°—Ä–µ–¥–Ω—è—è | Swiss Eph | ‚úÖ Ready |
| 6 | Dream norms | Hardcoded | Backend | üü° –°—Ä–µ–¥–Ω—è—è | JSON file | ‚úÖ Works |
| 7 | LLM fallback | Generic message | Backend | üü¢ –ù–∏–∑–∫–∞—è | Better text | ‚è≥ TODO |
| 8 | Dream interp rules | Templates | Backend | üü¢ –ù–∏–∑–∫–∞—è | Better rules | ‚è≥ TODO |
| 9-12 | Test mocks | Jest/Playwright | Tests | üü¢ N/A | Keep | ‚úÖ OK |
| 13-18 | Knowledge bases | Real data | Backend | ‚úÖ Production | Keep | ‚úÖ OK |

---

## ‚ú® –í–´–í–û–î–´

### –ì–ª–∞–≤–Ω–æ–µ
**–°–∏—Å—Ç–µ–º–∞ –∏–º–µ–µ—Ç —Ö–æ—Ä–æ—à—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É fallback'–æ–≤:**
- API ‚Üí Hardcoded fallback ‚Üí Error message
- –ö–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- –ù–∏—á–µ–≥–æ –Ω–µ –ª–æ–º–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ API

### –ß—Ç–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å
1. ‚úÖ **GeoNames** - –ì–æ—Ç–æ–≤–æ (—É–ª—É—á—à–µ–Ω–æ –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏)
2. ‚úÖ **Lunar data** - –ì–æ—Ç–æ–≤–æ (—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ Render)
3. ‚úÖ **Ephemeris** - –ì–æ—Ç–æ–≤–æ (pyswisseph —Ä–∞–±–æ—Ç–∞–µ—Ç)
4. ‚è≥ **LLM fallback** - –£–ª—É—á—à–∏—Ç—å —Ç–µ–∫—Å—Ç –æ—à–∏–±–∫–∏
5. ‚è≥ **Dream rules** - –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è –ª—É—á—à–µ–≥–æ fallback
6. ‚è≥ **E2E tests** - –î–æ–±–∞–≤–∏—Ç—å –º–æ–∫ –¥–ª—è `/api/timezones`

### –†–∏—Å–∫–∏ –ù–ï–¢
- –í—Å–µ mocks –∏–º–µ—é—Ç fallback'–∏
- –í—Å–µ fallback'–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- Production data –æ—Ç–¥–µ–ª–µ–Ω–∞ –æ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ù–∞ Render —Ä–∞–±–æ—Ç–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ API

**–°—Ç–∞—Ç—É—Å**: üü¢ **–ì–û–¢–û–í–û –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É**
